(function(B){var A={set:{colors:1,values:1,backgroundColor:1,scaleColors:1,normalizeFunction:1,focus:1},get:{selectedRegions:1,selectedMarkers:1,mapObject:1,regionName:1}};B.fn.vectorMap=function(E){var C,D,F,C=this.children(".jvectormap-container").data("mapObject");if(E==="addMap"){jvm.WorldMap.maps[arguments[1]]=arguments[2]}else{if((E==="set"||E==="get")&&A[E][arguments[1]]){D=arguments[1].charAt(0).toUpperCase()+arguments[1].substr(1);return C[E+D].apply(C,Array.prototype.slice.call(arguments,2))}else{E=E||{};E.container=this;C=new jvm.WorldMap(E)}}return this}})(jQuery);(function(D){var B=["DOMMouseScroll","mousewheel"];if(D.event.fixHooks){for(var A=B.length;A;){D.event.fixHooks[B[--A]]=D.event.mouseHooks}}D.event.special.mousewheel={setup:function(){if(this.addEventListener){for(var E=B.length;E;){this.addEventListener(B[--E],C,false)}}else{this.onmousewheel=C}},teardown:function(){if(this.removeEventListener){for(var E=B.length;E;){this.removeEventListener(B[--E],C,false)}}else{this.onmousewheel=null}}};D.fn.extend({mousewheel:function(E){return E?this.bind("mousewheel",E):this.trigger("mousewheel")},unmousewheel:function(E){return this.unbind("mousewheel",E)}});function C(I){var G=I||window.event,K=[].slice.call(arguments,1),F=0,E=true,J=0,H=0;I=D.event.fix(G);I.type="mousewheel";if(G.wheelDelta){F=G.wheelDelta/120}if(G.detail){F=-G.detail/3}H=F;if(G.axis!==undefined&&G.axis===G.HORIZONTAL_AXIS){H=0;J=-1*F}if(G.wheelDeltaY!==undefined){H=G.wheelDeltaY/120}if(G.wheelDeltaX!==undefined){J=-1*G.wheelDeltaX/120}K.unshift(I,F,J,H);return(D.event.dispatch||D.event.handle).apply(this,K)}})(jQuery);var jvm={inherits:function(A,C){function B(){}B.prototype=C.prototype;A.prototype=new B();A.prototype.constructor=A;A.parentClass=C},mixin:function(C,A){var B;for(B in A.prototype){if(A.prototype.hasOwnProperty(B)){C.prototype[B]=A.prototype[B]}}},min:function(C){var A=Number.MAX_VALUE,B;if(C instanceof Array){for(B=0;B<C.length;B++){if(C[B]<A){A=C[B]}}}else{for(B in C){if(C[B]<A){A=C[B]}}}return A},max:function(B){var C=Number.MIN_VALUE,A;if(B instanceof Array){for(A=0;A<B.length;A++){if(B[A]>C){C=B[A]}}}else{for(A in B){if(B[A]>C){C=B[A]}}}return C},keys:function(B){var C=[],A;for(A in B){C.push(A)}return C},values:function(C){var D=[],A,B;for(B=0;B<arguments.length;B++){C=arguments[B];for(A in C){D.push(C[A])}}return D}};jvm.$=jQuery;jvm.AbstractElement=function(B,A){this.node=this.createElement(B);this.name=B;this.properties={};if(A){this.set(A)}};jvm.AbstractElement.prototype.set=function(B,C){var A;if(typeof B==="object"){for(A in B){this.properties[A]=B[A];this.applyAttr(A,B[A])}}else{this.properties[B]=C;this.applyAttr(B,C)}};jvm.AbstractElement.prototype.get=function(A){return this.properties[A]};jvm.AbstractElement.prototype.applyAttr=function(A,B){this.node.setAttribute(A,B)};jvm.AbstractElement.prototype.remove=function(){jvm.$(this.node).remove()};jvm.AbstractCanvasElement=function(B,C,A){this.container=B;this.setSize(C,A);this.rootElement=new jvm[this.classPrefix+"GroupElement"]();this.node.appendChild(this.rootElement.node);this.container.appendChild(this.node)};jvm.AbstractCanvasElement.prototype.add=function(B,A){A=A||this.rootElement;A.add(B);B.canvas=this};jvm.AbstractCanvasElement.prototype.addPath=function(C,D,B){var A=new jvm[this.classPrefix+"PathElement"](C,D);this.add(A,B);return A};jvm.AbstractCanvasElement.prototype.addCircle=function(C,D,B){var A=new jvm[this.classPrefix+"CircleElement"](C,D);this.add(A,B);return A};jvm.AbstractCanvasElement.prototype.addGroup=function(A){var B=new jvm[this.classPrefix+"GroupElement"]();if(A){A.node.appendChild(B.node)}else{this.node.appendChild(B.node)}B.canvas=this;return B};jvm.AbstractShapeElement=function(B,A,C){this.style=C||{};this.style.current={};this.isHovered=false;this.isSelected=false;this.updateStyle()};jvm.AbstractShapeElement.prototype.setHovered=function(A){if(this.isHovered!==A){this.isHovered=A;this.updateStyle()}};jvm.AbstractShapeElement.prototype.setSelected=function(A){if(this.isSelected!==A){this.isSelected=A;this.updateStyle();jvm.$(this.node).trigger("selected",[A])}};jvm.AbstractShapeElement.prototype.setStyle=function(A,C){var B={};if(typeof A==="object"){B=A}else{B[A]=C}jvm.$.extend(this.style.current,B);this.updateStyle()};jvm.AbstractShapeElement.prototype.updateStyle=function(){var A={};jvm.AbstractShapeElement.mergeStyles(A,this.style.initial);jvm.AbstractShapeElement.mergeStyles(A,this.style.current);if(this.isHovered){jvm.AbstractShapeElement.mergeStyles(A,this.style.hover)}if(this.isSelected){jvm.AbstractShapeElement.mergeStyles(A,this.style.selected);if(this.isHovered){jvm.AbstractShapeElement.mergeStyles(A,this.style.selectedHover)}}this.set(A)};jvm.AbstractShapeElement.mergeStyles=function(B,C){var A;C=C||{};for(A in C){if(C[A]===null){delete B[A]}else{B[A]=C[A]}}};jvm.SVGElement=function(B,A){jvm.SVGElement.parentClass.apply(this,arguments)};jvm.inherits(jvm.SVGElement,jvm.AbstractElement);jvm.SVGElement.svgns="http://www.w3.org/2000/svg";jvm.SVGElement.prototype.createElement=function(A){return document.createElementNS(jvm.SVGElement.svgns,A)};jvm.SVGElement.prototype.addClass=function(A){this.node.setAttribute("class",A)};jvm.SVGElement.prototype.getElementCtr=function(A){return jvm["SVG"+A]};jvm.SVGElement.prototype.getBBox=function(){return this.node.getBBox()};jvm.SVGGroupElement=function(){jvm.SVGGroupElement.parentClass.call(this,"g")};jvm.inherits(jvm.SVGGroupElement,jvm.SVGElement);jvm.SVGGroupElement.prototype.add=function(A){this.node.appendChild(A.node)};jvm.SVGCanvasElement=function(B,C,A){this.classPrefix="SVG";jvm.SVGCanvasElement.parentClass.call(this,"svg");jvm.AbstractCanvasElement.apply(this,arguments)};jvm.inherits(jvm.SVGCanvasElement,jvm.SVGElement);jvm.mixin(jvm.SVGCanvasElement,jvm.AbstractCanvasElement);jvm.SVGCanvasElement.prototype.setSize=function(B,A){this.width=B;this.height=A;this.node.setAttribute("width",B);this.node.setAttribute("height",A)};jvm.SVGCanvasElement.prototype.applyTransformParams=function(B,A,C){this.scale=B;this.transX=A;this.transY=C;this.rootElement.node.setAttribute("transform","scale("+B+") translate("+A+", "+C+")")};jvm.SVGShapeElement=function(B,A,C){jvm.SVGShapeElement.parentClass.call(this,B,A);jvm.AbstractShapeElement.apply(this,arguments)};jvm.inherits(jvm.SVGShapeElement,jvm.SVGElement);jvm.mixin(jvm.SVGShapeElement,jvm.AbstractShapeElement);jvm.SVGPathElement=function(A,B){jvm.SVGPathElement.parentClass.call(this,"path",A,B);this.node.setAttribute("fill-rule","evenodd")};jvm.inherits(jvm.SVGPathElement,jvm.SVGShapeElement);jvm.SVGCircleElement=function(A,B){jvm.SVGCircleElement.parentClass.call(this,"circle",A,B)};jvm.inherits(jvm.SVGCircleElement,jvm.SVGShapeElement);jvm.VMLElement=function(B,A){if(!jvm.VMLElement.VMLInitialized){jvm.VMLElement.initializeVML()}jvm.VMLElement.parentClass.apply(this,arguments)};jvm.inherits(jvm.VMLElement,jvm.AbstractElement);jvm.VMLElement.VMLInitialized=false;jvm.VMLElement.initializeVML=function(){try{if(!document.namespaces.rvml){document.namespaces.add("rvml","urn:schemas-microsoft-com:vml")}jvm.VMLElement.prototype.createElement=function(B){return document.createElement("<rvml:"+B+' class="rvml">')}}catch(A){jvm.VMLElement.prototype.createElement=function(B){return document.createElement("<"+B+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}document.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");jvm.VMLElement.VMLInitialized=true};jvm.VMLElement.prototype.getElementCtr=function(A){return jvm["VML"+A]};jvm.VMLElement.prototype.addClass=function(A){jvm.$(this.node).addClass(A)};jvm.VMLElement.prototype.applyAttr=function(B,A){this.node[B]=A};jvm.VMLElement.prototype.getBBox=function(){var A=jvm.$(this.node);return{x:A.position().left/this.canvas.scale,y:A.position().top/this.canvas.scale,width:A.width()/this.canvas.scale,height:A.height()/this.canvas.scale}};jvm.VMLGroupElement=function(){jvm.VMLGroupElement.parentClass.call(this,"group");this.node.style.left="0px";this.node.style.top="0px";this.node.coordorigin="0 0"};jvm.inherits(jvm.VMLGroupElement,jvm.VMLElement);jvm.VMLGroupElement.prototype.add=function(A){this.node.appendChild(A.node)};jvm.VMLCanvasElement=function(B,C,A){this.classPrefix="VML";jvm.VMLCanvasElement.parentClass.call(this,"group");jvm.AbstractCanvasElement.apply(this,arguments);this.node.style.position="absolute"};jvm.inherits(jvm.VMLCanvasElement,jvm.VMLElement);jvm.mixin(jvm.VMLCanvasElement,jvm.AbstractCanvasElement);jvm.VMLCanvasElement.prototype.setSize=function(E,A){var F,B,C,D;this.width=E;this.height=A;this.node.style.width=E+"px";this.node.style.height=A+"px";this.node.coordsize=E+" "+A;this.node.coordorigin="0 0";if(this.rootElement){F=this.rootElement.node.getElementsByTagName("shape");for(C=0,D=F.length;C<D;C++){F[C].coordsize=E+" "+A;F[C].style.width=E+"px";F[C].style.height=A+"px"}B=this.node.getElementsByTagName("group");for(C=0,D=B.length;C<D;C++){B[C].coordsize=E+" "+A;B[C].style.width=E+"px";B[C].style.height=A+"px"}}};jvm.VMLCanvasElement.prototype.applyTransformParams=function(B,A,C){this.scale=B;this.transX=A;this.transY=C;this.rootElement.node.coordorigin=(this.width-A-this.width/100)+","+(this.height-C-this.height/100);this.rootElement.node.coordsize=this.width/B+","+this.height/B};jvm.VMLShapeElement=function(B,A){jvm.VMLShapeElement.parentClass.call(this,B,A);this.fillElement=new jvm.VMLElement("fill");this.strokeElement=new jvm.VMLElement("stroke");this.node.appendChild(this.fillElement.node);this.node.appendChild(this.strokeElement.node);this.node.stroked=false;jvm.AbstractShapeElement.apply(this,arguments)};jvm.inherits(jvm.VMLShapeElement,jvm.VMLElement);jvm.mixin(jvm.VMLShapeElement,jvm.AbstractShapeElement);jvm.VMLShapeElement.prototype.applyAttr=function(B,A){switch(B){case"fill":this.node.fillcolor=A;break;case"fill-opacity":this.fillElement.node.opacity=Math.round(A*100)+"%";break;case"stroke":if(A==="none"){this.node.stroked=false}else{this.node.stroked=true}this.node.strokecolor=A;break;case"stroke-opacity":this.strokeElement.node.opacity=Math.round(A*100)+"%";break;case"stroke-width":if(parseInt(A,10)===0){this.node.stroked=false}else{this.node.stroked=true}this.node.strokeweight=A;break;case"d":this.node.path=jvm.VMLPathElement.pathSvgToVml(A);break;default:jvm.VMLShapeElement.parentClass.prototype.applyAttr.apply(this,arguments)}};jvm.VMLPathElement=function(A,B){var C=new jvm.VMLElement("skew");jvm.VMLPathElement.parentClass.call(this,"shape",A,B);this.node.coordorigin="0 0";C.node.on=true;C.node.matrix="0.01,0,0,0.01,0,0";C.node.offset="0,0";this.node.appendChild(C.node)};jvm.inherits(jvm.VMLPathElement,jvm.VMLShapeElement);jvm.VMLPathElement.prototype.applyAttr=function(B,A){if(B==="d"){this.node.path=jvm.VMLPathElement.pathSvgToVml(A)}else{jvm.VMLShapeElement.prototype.applyAttr.call(this,B,A)}};jvm.VMLPathElement.pathSvgToVml=function(F){var B="",E=0,A=0,D,C;F=F.replace(/(-?\d+)e(-?\d+)/g,"0");return F.replace(/([MmLlHhVvCcSs])\s*((?:-?\d*(?:\.\d+)?\s*,?\s*)+)/g,function(J,L,H,K){H=H.replace(/(\d)-/g,"$1,-").replace(/^\s+/g,"").replace(/\s+$/g,"").replace(/\s+/g,",").split(",");if(!H[0]){H.shift()}for(var G=0,I=H.length;G<I;G++){H[G]=Math.round(100*H[G])}switch(L){case"m":E+=H[0];A+=H[1];return"t"+H.join(",");break;case"M":E=H[0];A=H[1];return"m"+H.join(",");break;case"l":E+=H[0];A+=H[1];return"r"+H.join(",");break;case"L":E=H[0];A=H[1];return"l"+H.join(",");break;case"h":E+=H[0];return"r"+H[0]+",0";break;case"H":E=H[0];return"l"+E+","+A;break;case"v":A+=H[0];return"r0,"+H[0];break;case"V":A=H[0];return"l"+E+","+A;break;case"c":D=E+H[H.length-4];C=A+H[H.length-3];E+=H[H.length-2];A+=H[H.length-1];return"v"+H.join(",");break;case"C":D=H[H.length-4];C=H[H.length-3];E=H[H.length-2];A=H[H.length-1];return"c"+H.join(",");break;case"s":H.unshift(A-C);H.unshift(E-D);D=E+H[H.length-4];C=A+H[H.length-3];E+=H[H.length-2];A+=H[H.length-1];return"v"+H.join(",");break;case"S":H.unshift(A+A-C);H.unshift(E+E-D);D=H[H.length-4];C=H[H.length-3];E=H[H.length-2];A=H[H.length-1];return"c"+H.join(",");break}return""}).replace(/z/g,"e")};jvm.VMLCircleElement=function(A,B){jvm.VMLCircleElement.parentClass.call(this,"oval",A,B)};jvm.inherits(jvm.VMLCircleElement,jvm.VMLShapeElement);jvm.VMLCircleElement.prototype.applyAttr=function(B,A){switch(B){case"r":this.node.style.width=A*2+"px";this.node.style.height=A*2+"px";this.applyAttr("cx",this.get("cx")||0);this.applyAttr("cy",this.get("cy")||0);break;case"cx":if(!A){return}this.node.style.left=A-(this.get("r")||0)+"px";break;case"cy":if(!A){return}this.node.style.top=A-(this.get("r")||0)+"px";break;default:jvm.VMLCircleElement.parentClass.prototype.applyAttr.call(this,B,A)}};jvm.VectorCanvas=function(B,C,A){this.mode=window.SVGAngle?"svg":"vml";if(this.mode=="svg"){this.impl=new jvm.SVGCanvasElement(B,C,A)}else{this.impl=new jvm.VMLCanvasElement(B,C,A)}return this.impl};jvm.SimpleScale=function(A){this.scale=A};jvm.SimpleScale.prototype.getValue=function(A){return A};jvm.NumericScale=function(C,A,D,B){this.scale=[];A=A||"linear";if(C){this.setScale(C)}if(A){this.setNormalizeFunction(A)}if(D){this.setMin(D)}if(B){this.setMax(B)}};jvm.NumericScale.prototype={setMin:function(A){this.clearMinValue=A;if(typeof this.normalize==="function"){this.minValue=this.normalize(A)}else{this.minValue=A}},setMax:function(A){this.clearMaxValue=A;if(typeof this.normalize==="function"){this.maxValue=this.normalize(A)}else{this.maxValue=A}},setScale:function(B){var A;for(A=0;A<B.length;A++){this.scale[A]=[B[A]]}},setNormalizeFunction:function(A){if(A==="polynomial"){this.normalize=function(B){return Math.pow(B,0.2)}}else{if(A==="linear"){delete this.normalize}else{this.normalize=A}}this.setMin(this.clearMinValue);this.setMax(this.clearMaxValue)},getValue:function(E){var B=[],C=0,D,A=0,F;if(typeof this.normalize==="function"){E=this.normalize(E)}for(A=0;A<this.scale.length-1;A++){D=this.vectorLength(this.vectorSubtract(this.scale[A+1],this.scale[A]));B.push(D);C+=D}F=(this.maxValue-this.minValue)/C;for(A=0;A<B.length;A++){B[A]*=F}A=0;E-=this.minValue;while(E-B[A]>=0){E-=B[A];A++}if(A==this.scale.length-1){E=this.vectorToNum(this.scale[A])}else{E=(this.vectorToNum(this.vectorAdd(this.scale[A],this.vectorMult(this.vectorSubtract(this.scale[A+1],this.scale[A]),(E)/(B[A])))))}return E},vectorToNum:function(C){var B=0,A;for(A=0;A<C.length;A++){B+=Math.round(C[A])*Math.pow(256,C.length-A-1)}return B},vectorSubtract:function(B,C){var D=[],A;for(A=0;A<B.length;A++){D[A]=B[A]-C[A]}return D},vectorAdd:function(B,C){var D=[],A;for(A=0;A<B.length;A++){D[A]=B[A]+C[A]}return D},vectorMult:function(D,C){var B=[],A;for(A=0;A<D.length;A++){B[A]=D[A]*C}return B},vectorLength:function(C){var B=0,A;for(A=0;A<C.length;A++){B+=C[A]*C[A]}return Math.sqrt(B)}};jvm.OrdinalScale=function(A){this.scale=A};jvm.OrdinalScale.prototype.getValue=function(A){return this.scale[A]};jvm.ColorScale=function(C,A,D,B){jvm.ColorScale.parentClass.apply(this,arguments)};jvm.inherits(jvm.ColorScale,jvm.NumericScale);jvm.ColorScale.prototype.setScale=function(B){var A;for(A=0;A<B.length;A++){this.scale[A]=jvm.ColorScale.rgbToArray(B[A])}};jvm.ColorScale.prototype.getValue=function(A){return jvm.ColorScale.numToRgb(jvm.ColorScale.parentClass.prototype.getValue.call(this,A))};jvm.ColorScale.arrayToRgb=function(D){var C="#",A,B;for(B=0;B<D.length;B++){A=D[B].toString(16);C+=A.length==1?"0"+A:A}return C};jvm.ColorScale.numToRgb=function(A){A=A.toString(16);while(A.length<6){A="0"+A}return"#"+A};jvm.ColorScale.rgbToArray=function(A){A=A.substr(1);return[parseInt(A.substr(0,2),16),parseInt(A.substr(2,2),16),parseInt(A.substr(4,2),16)]};jvm.DataSeries=function(C,A){var B;C=C||{};C.attribute=C.attribute||"fill";this.elements=A;this.params=C;if(C.attributes){this.setAttributes(C.attributes)}if(jvm.$.isArray(C.scale)){B=(C.attribute==="fill"||C.attribute==="stroke")?jvm.ColorScale:jvm.NumericScale;this.scale=new B(C.scale,C.normalizeFunction,C.min,C.max)}else{if(C.scale){this.scale=new jvm.OrdinalScale(C.scale)}else{this.scale=new jvm.SimpleScale(C.scale)}}this.values=C.values||{};this.setValues(this.values)};jvm.DataSeries.prototype={setAttributes:function(A,D){var C=A,B;if(typeof A=="string"){if(this.elements[A]){this.elements[A].setStyle(this.params.attribute,D)}}else{for(B in C){if(this.elements[B]){this.elements[B].element.setStyle(this.params.attribute,C[B])}}}},setValues:function(E){var F=Number.MIN_VALUE,A=Number.MAX_VALUE,C,B,D={};if(!(this.scale instanceof jvm.OrdinalScale)&&!(this.scale instanceof jvm.SimpleScale)){if(!this.params.min||!this.params.max){for(B in E){C=parseFloat(E[B]);if(C>F){F=E[B]}if(C<A){A=C}}if(!this.params.min){this.scale.setMin(A)}if(!this.params.max){this.scale.setMax(F)}this.params.min=A;this.params.max=F}for(B in E){C=parseFloat(E[B]);if(!isNaN(C)){D[B]=this.scale.getValue(C)}else{D[B]=this.elements[B].element.style.initial[this.params.attribute]}}}else{for(B in E){if(E[B]){D[B]=this.scale.getValue(E[B])}else{D[B]=this.elements[B].element.style.initial[this.params.attribute]}}}this.setAttributes(D);jvm.$.extend(this.values,E)},clear:function(){var A,B={};for(A in this.values){if(this.elements[A]){B[A]=this.elements[A].element.style.initial[this.params.attribute]}}this.setAttributes(B);this.values={}},setScale:function(A){this.scale.setScale(A);if(this.values){this.setValues(this.values)}},setNormalizeFunction:function(A){this.scale.setNormalizeFunction(A);if(this.values){this.setValues(this.values)}}};jvm.Proj={degRad:180/Math.PI,radDeg:Math.PI/180,radius:6381372,sgn:function(A){if(A>0){return 1}else{if(A<0){return -1}else{return A}}},mill:function(B,A,C){return{x:this.radius*(A-C)*this.radDeg,y:-this.radius*Math.log(Math.tan((45+0.4*B)*this.radDeg))/0.8}},mill_inv:function(A,B,C){return{lat:(2.5*Math.atan(Math.exp(0.8*B/this.radius))-5*Math.PI/8)*this.degRad,lng:(C*this.radDeg+A/this.radius)*this.degRad}},merc:function(B,A,C){return{x:this.radius*(A-C)*this.radDeg,y:-this.radius*Math.log(Math.tan(Math.PI/4+B*Math.PI/360))}},merc_inv:function(A,B,C){return{lat:(2*Math.atan(Math.exp(B/this.radius))-Math.PI/2)*this.degRad,lng:(C*this.radDeg+A/this.radius)*this.degRad}},aea:function(B,D,M){var I=0,H=M*this.radDeg,J=29.5*this.radDeg,K=45.5*this.radDeg,L=B*this.radDeg,G=D*this.radDeg,N=(Math.sin(J)+Math.sin(K))/2,E=Math.cos(J)*Math.cos(J)+2*N*Math.sin(J),F=N*(G-H),O=Math.sqrt(E-2*N*Math.sin(L))/N,A=Math.sqrt(E-2*N*Math.sin(I))/N;return{x:O*Math.sin(F)*this.radius,y:-(A-O*Math.cos(F))*this.radius}},aea_inv:function(K,F,L){var O=K/this.radius,M=F/this.radius,H=0,B=L*this.radDeg,I=29.5*this.radDeg,J=45.5*this.radDeg,G=(Math.sin(I)+Math.sin(J))/2,D=Math.cos(I)*Math.cos(I)+2*G*Math.sin(I),A=Math.sqrt(D-2*G*Math.sin(H))/G,N=Math.sqrt(O*O+(A-M)*(A-M)),E=Math.atan(O/(A-M));return{lat:(Math.asin((D-N*N*G*G)/(2*G)))*this.degRad,lng:(B+E/G)*this.degRad}},lcc:function(B,C,L){var H=0,G=L*this.radDeg,I=C*this.radDeg,J=33*this.radDeg,K=45*this.radDeg,D=B*this.radDeg,M=Math.log(Math.cos(J)*(1/Math.cos(K)))/Math.log(Math.tan(Math.PI/4+K/2)*(1/Math.tan(Math.PI/4+J/2))),E=(Math.cos(J)*Math.pow(Math.tan(Math.PI/4+J/2),M))/M,N=E*Math.pow(1/Math.tan(Math.PI/4+D/2),M),A=E*Math.pow(1/Math.tan(Math.PI/4+H/2),M);return{x:N*Math.sin(M*(I-G))*this.radius,y:-(A-N*Math.cos(M*(I-G)))*this.radius}},lcc_inv:function(K,D,L){var O=K/this.radius,M=D/this.radius,H=0,B=L*this.radDeg,I=33*this.radDeg,J=45*this.radDeg,G=Math.log(Math.cos(I)*(1/Math.cos(J)))/Math.log(Math.tan(Math.PI/4+J/2)*(1/Math.tan(Math.PI/4+I/2))),E=(Math.cos(I)*Math.pow(Math.tan(Math.PI/4+I/2),G))/G,A=E*Math.pow(1/Math.tan(Math.PI/4+H/2),G),N=this.sgn(G)*Math.sqrt(O*O+(A-M)*(A-M)),C=Math.atan(O/(A-M));return{lat:(2*Math.atan(Math.pow(E/N,1/G))-Math.PI/2)*this.degRad,lng:(B+C/G)*this.degRad}}};jvm.WorldMap=function(C){var A=this,B;this.params=jvm.$.extend(true,{},jvm.WorldMap.defaultParams,C);if(!jvm.WorldMap.maps[this.params.map]){throw new Error("Attempt to use map which was not loaded: "+this.params.map)}this.mapData=jvm.WorldMap.maps[this.params.map];this.markers={};this.regions={};this.regionsColors={};this.regionsData={};this.container=jvm.$("<div>").css({width:"100%",height:"100%"}).addClass("jvectormap-container");this.params.container.append(this.container);this.container.data("mapObject",this);this.container.css({position:"relative",overflow:"hidden"});this.defaultWidth=this.mapData.width;this.defaultHeight=this.mapData.height;this.setBackgroundColor(this.params.backgroundColor);this.onResize=function(){A.setSize()};jvm.$(window).resize(this.onResize);for(B in jvm.WorldMap.apiEvents){if(this.params[B]){this.container.bind(jvm.WorldMap.apiEvents[B]+".jvectormap",this.params[B])}}this.canvas=new jvm.VectorCanvas(this.container[0],this.width,this.height);if(("ontouchstart" in window)||(window.DocumentTouch&&document instanceof DocumentTouch)){if(this.params.bindTouchEvents){this.bindContainerTouchEvents()}}else{this.bindContainerEvents()}this.bindElementEvents();this.createLabel();if(this.params.zoomButtons){this.bindZoomButtons()}this.createRegions();this.createMarkers(this.params.markers||{});this.setSize();if(this.params.focusOn){if(typeof this.params.focusOn==="object"){this.setFocus.call(this,this.params.focusOn.scale,this.params.focusOn.x,this.params.focusOn.y)}else{this.setFocus.call(this,this.params.focusOn)}}if(this.params.selectedRegions){this.setSelectedRegions(this.params.selectedRegions)}if(this.params.selectedMarkers){this.setSelectedMarkers(this.params.selectedMarkers)}if(this.params.series){this.createSeries()}};jvm.WorldMap.prototype={transX:0,transY:0,scale:1,baseTransX:0,baseTransY:0,baseScale:1,width:0,height:0,setBackgroundColor:function(A){this.container.css("background-color",A)},resize:function(){var A=this.baseScale;if(this.width/this.height>this.defaultWidth/this.defaultHeight){this.baseScale=this.height/this.defaultHeight;this.baseTransX=Math.abs(this.width-this.defaultWidth*this.baseScale)/(2*this.baseScale)}else{this.baseScale=this.width/this.defaultWidth;this.baseTransY=Math.abs(this.height-this.defaultHeight*this.baseScale)/(2*this.baseScale)}this.scale*=this.baseScale/A;this.transX*=this.baseScale/A;this.transY*=this.baseScale/A},setSize:function(){this.width=this.container.width();this.height=this.container.height();this.resize();this.canvas.setSize(this.width,this.height);this.applyTransform()},reset:function(){var A,B;for(A in this.series){for(B=0;B<this.series[A].length;B++){this.series[A][B].clear()}}this.scale=this.baseScale;this.transX=this.baseTransX;this.transY=this.baseTransY;this.applyTransform()},applyTransform:function(){var D,C,B,A;if(this.defaultWidth*this.scale<=this.width){D=(this.width-this.defaultWidth*this.scale)/(2*this.scale);B=(this.width-this.defaultWidth*this.scale)/(2*this.scale)}else{D=0;B=(this.width-this.defaultWidth*this.scale)/this.scale}if(this.defaultHeight*this.scale<=this.height){C=(this.height-this.defaultHeight*this.scale)/(2*this.scale);A=(this.height-this.defaultHeight*this.scale)/(2*this.scale)}else{C=0;A=(this.height-this.defaultHeight*this.scale)/this.scale}if(this.transY>C){this.transY=C}else{if(this.transY<A){this.transY=A}}if(this.transX>D){this.transX=D}else{if(this.transX<B){this.transX=B}}this.canvas.applyTransformParams(this.scale,this.transX,this.transY);if(this.markers){this.repositionMarkers()}this.container.trigger("viewportChange",[this.scale/this.baseScale,this.transX,this.transY])},bindContainerEvents:function(){var C=false,B,A,D=this;this.container.mousemove(function(E){if(C){D.transX-=(B-E.pageX)/D.scale;D.transY-=(A-E.pageY)/D.scale;D.applyTransform();B=E.pageX;A=E.pageY}return false}).mousedown(function(E){C=true;B=E.pageX;A=E.pageY;return false});jvm.$("body").mouseup(function(){C=false});if(this.params.zoomOnScroll){this.container.mousewheel(function(G,I,L,E){var F=jvm.$(D.container).offset(),J=G.pageX-F.left,K=G.pageY-F.top,H=Math.pow(1.3,E);D.setScale(D.scale*H,J,K);G.preventDefault()})}},bindContainerTouchEvents:function(){var A,H,G=this,D,F,I,B,C,E=function(K){var O=K.originalEvent.touches,J,N,M,L;if(K.type=="touchstart"){C=0}if(O.length==1){if(C==1){M=G.transX;L=G.transY;G.transX-=(D-O[0].pageX)/G.scale;G.transY-=(F-O[0].pageY)/G.scale;G.applyTransform();if(M!=G.transX||L!=G.transY){K.preventDefault()}}D=O[0].pageX;F=O[0].pageY}else{if(O.length==2){if(C==2){N=Math.sqrt(Math.pow(O[0].pageX-O[1].pageX,2)+Math.pow(O[0].pageY-O[1].pageY,2))/H;G.setScale(A*N,I,B);K.preventDefault()}else{J=jvm.$(G.container).offset();if(O[0].pageX>O[1].pageX){I=O[1].pageX+(O[0].pageX-O[1].pageX)/2}else{I=O[0].pageX+(O[1].pageX-O[0].pageX)/2}if(O[0].pageY>O[1].pageY){B=O[1].pageY+(O[0].pageY-O[1].pageY)/2}else{B=O[0].pageY+(O[1].pageY-O[0].pageY)/2}I-=J.left;B-=J.top;A=G.scale;H=Math.sqrt(Math.pow(O[0].pageX-O[1].pageX,2)+Math.pow(O[0].pageY-O[1].pageY,2))}}}C=O.length};jvm.$(this.container).bind("touchstart",E);jvm.$(this.container).bind("touchmove",E)},bindElementEvents:function(){var A=this,B;this.container.mousemove(function(){B=true});this.container.delegate("[class~='jvectormap-element']","mouseover mouseout",function(C){var H=this,K=jvm.$(this).attr("class").baseVal?jvm.$(this).attr("class").baseVal:jvm.$(this).attr("class"),J=K.indexOf("jvectormap-region")===-1?"marker":"region",F=J=="region"?jvm.$(this).attr("data-code"):jvm.$(this).attr("data-index"),D=J=="region"?A.regions[F].element:A.markers[F].element,E=J=="region"?A.mapData.paths[F].name:(A.markers[F].config.name||""),I=jvm.$.Event(J+"LabelShow.jvectormap"),G=jvm.$.Event(J+"Over.jvectormap");if(C.type=="mouseover"){A.container.trigger(G,[F]);if(!G.isDefaultPrevented()){D.setHovered(true)}if(!I.isDefaultPrevented()){}}else{D.setHovered(false);A.container.trigger(J+"Out.jvectormap",[F])}});this.container.delegate("[class~='jvectormap-element']","mousedown",function(C){B=false});this.container.delegate("[class~='jvectormap-element']","mouseup",function(E){var I=this,F=jvm.$(this).attr("class").baseVal?jvm.$(this).attr("class").baseVal:jvm.$(this).attr("class"),C=F.indexOf("jvectormap-region")===-1?"marker":"region",G=C=="region"?jvm.$(this).attr("data-code"):jvm.$(this).attr("data-index"),D=jvm.$.Event(C+"Click.jvectormap"),H=C=="region"?A.regions[G].element:A.markers[G].element;if(!B){A.container.trigger(D,[G]);if((C==="region"&&A.params.regionsSelectable)||(C==="marker"&&A.params.markersSelectable)){if(!D.isDefaultPrevented()){if(A.params[C+"sSelectableOne"]){A.clearSelected(C+"s")}H.setSelected(!H.isSelected)}}}})},bindZoomButtons:function(){},createLabel:function(){},setScale:function(E,B,A,F){var C,D=jvm.$.Event("zoom.jvectormap");if(E>this.params.zoomMax*this.baseScale){E=this.params.zoomMax*this.baseScale}else{if(E<this.params.zoomMin*this.baseScale){E=this.params.zoomMin*this.baseScale}}if(typeof B!="undefined"&&typeof A!="undefined"){C=E/this.scale;if(F){this.transX=B+this.defaultWidth*(this.width/(this.defaultWidth*E))/2;this.transY=A+this.defaultHeight*(this.height/(this.defaultHeight*E))/2}else{this.transX-=(C-1)/E*B;this.transY-=(C-1)/E*A}}this.scale=E;this.applyTransform();this.container.trigger(D,[E/this.baseScale])},setFocus:function(B,G,F){var H,D,A,C,E;if(jvm.$.isArray(B)||this.regions[B]){if(jvm.$.isArray(B)){C=B}else{C=[B]}for(E=0;E<C.length;E++){if(this.regions[C[E]]){D=this.regions[C[E]].element.getBBox();if(D){if(typeof H=="undefined"){H=D}else{A={x:Math.min(H.x,D.x),y:Math.min(H.y,D.y),width:Math.max(H.x+H.width,D.x+D.width)-Math.min(H.x,D.x),height:Math.max(H.y+H.height,D.y+D.height)-Math.min(H.y,D.y)};H=A}}}}this.setScale(Math.min(this.width/H.width,this.height/H.height),-(H.x+H.width/2),-(H.y+H.height/2),true)}else{B=B*this.baseScale;this.setScale(B,-G*this.defaultWidth,-F*this.defaultHeight,true)}},getSelected:function(A){var B,C=[];for(B in this[A]){if(this[A][B].element.isSelected){C.push(B)}}return C},getSelectedRegions:function(){return this.getSelected("regions")},getSelectedMarkers:function(){return this.getSelected("markers")},setSelected:function(A,C){var B;if(typeof C!="object"){C=[C]}if(jvm.$.isArray(C)){for(B=0;B<C.length;B++){this[A][C[B]].element.setSelected(true)}}else{for(B in C){this[A][B].element.setSelected(!!C[B])}}},setSelectedRegions:function(A){this.setSelected("regions",A)},setSelectedMarkers:function(A){this.setSelected("markers",A)},clearSelected:function(A){var C={},D=this.getSelected(A),B;for(B=0;B<D.length;B++){C[D[B]]=false}this.setSelected(A,C)},clearSelectedRegions:function(){this.clearSelected("regions")},clearSelectedMarkers:function(){this.clearSelected("markers")},getMapObject:function(){return this},getRegionName:function(A){return this.mapData.paths[A].name},createRegions:function(){var A,C,B=this;for(A in this.mapData.paths){C=this.canvas.addPath({d:this.mapData.paths[A].path,"data-code":A},jvm.$.extend(true,{},this.params.regionStyle));jvm.$(C.node).bind("selected",function(E,D){B.container.trigger("regionSelected.jvectormap",[jvm.$(this).attr("data-code"),D,B.getSelectedRegions()])});C.addClass("jvectormap-region jvectormap-element");this.regions[A]={element:C,config:this.mapData.paths[A]}}},createMarkers:function(B){var C,E,D,A,G,F=this;this.markersGroup=this.markersGroup||this.canvas.addGroup();if(jvm.$.isArray(B)){G=B.slice();B={};for(C=0;C<G.length;C++){B[C]=G[C]}}for(C in B){A=B[C] instanceof Array?{latLng:B[C]}:B[C];D=this.getMarkerPosition(A);if(D!==false){E=this.canvas.addCircle({"data-index":C,cx:D.x,cy:D.y},jvm.$.extend(true,{},this.params.markerStyle,{initial:A.style||{}}),this.markersGroup);E.addClass("jvectormap-marker jvectormap-element");jvm.$(E.node).bind("selected",function(I,H){F.container.trigger("markerSelected.jvectormap",[jvm.$(this).attr("data-index"),H,F.getSelectedMarkers()])});if(this.markers[C]){this.removeMarkers([C])}this.markers[C]={element:E,config:A}}}},repositionMarkers:function(){var A,B;for(A in this.markers){B=this.getMarkerPosition(this.markers[A].config);if(B!==false){this.markers[A].element.setStyle({cx:B.x,cy:B.y})}}},getMarkerPosition:function(A){if(jvm.WorldMap.maps[this.params.map].projection){return this.latLngToPoint.apply(this,A.latLng||[0,0])}else{return{x:A.coords[0]*this.scale+this.transX*this.scale,y:A.coords[1]*this.scale+this.transY*this.scale}}},addMarker:function(A,D,F){var G={},C=[],E,B,F=F||[];G[A]=D;for(B=0;B<F.length;B++){E={};E[A]=F[B];C.push(E)}this.addMarkers(G,C)},addMarkers:function(A,C){var B;C=C||[];this.createMarkers(A);for(B=0;B<C.length;B++){this.series.markers[B].setValues(C[B]||{})}},removeMarkers:function(A){var B;for(B=0;B<A.length;B++){this.markers[A[B]].element.remove();delete this.markers[A[B]]}},removeAllMarkers:function(){var A,B=[];for(A in this.markers){B.push(A)}this.removeMarkers(B)},latLngToPoint:function(B,C){var J,I=jvm.WorldMap.maps[this.params.map].projection,A=I.centralMeridian,E=this.width-this.baseTransX*2*this.baseScale,D=this.height-this.baseTransY*2*this.baseScale,H,F,G=this.scale/this.baseScale;if(C<(-180+A)){C+=360}J=jvm.Proj[I.type](B,C,A);H=this.getInsetForPoint(J.x,J.y);if(H){F=H.bbox;J.x=(J.x-F[0].x)/(F[1].x-F[0].x)*H.width*this.scale;J.y=(J.y-F[0].y)/(F[1].y-F[0].y)*H.height*this.scale;return{x:J.x+this.transX*this.scale+H.left*this.scale,y:J.y+this.transY*this.scale+H.top*this.scale}}else{return false}},pointToLatLng:function(J,H){var F=jvm.WorldMap.maps[this.params.map].projection,A=F.centralMeridian,G=jvm.WorldMap.maps[this.params.map].insets,D,E,I,C,B;for(D=0;D<G.length;D++){E=G[D];I=E.bbox;C=J-(this.transX*this.scale+E.left*this.scale);B=H-(this.transY*this.scale+E.top*this.scale);C=(C/(E.width*this.scale))*(I[1].x-I[0].x)+I[0].x;B=(B/(E.height*this.scale))*(I[1].y-I[0].y)+I[0].y;if(C>I[0].x&&C<I[1].x&&B>I[0].y&&B<I[1].y){return jvm.Proj[F.type+"_inv"](C,-B,A)}}return false},getInsetForPoint:function(B,C){var D=jvm.WorldMap.maps[this.params.map].insets,A,E;for(A=0;A<D.length;A++){E=D[A].bbox;if(B>E[0].x&&B<E[1].x&&C>E[0].y&&C<E[1].y){return D[A]}}},createSeries:function(){var B,A;this.series={markers:[],regions:[]};for(A in this.params.series){for(B=0;B<this.params.series[A].length;B++){this.series[A][B]=new jvm.DataSeries(this.params.series[A][B],this[A])}}},remove:function(){this.container.remove();jvm.$(window).unbind("resize",this.onResize)}};jvm.WorldMap.maps={};jvm.WorldMap.defaultParams={map:"world_mill_en",backgroundColor:"",zoomButtons:false,zoomOnScroll:false,zoomMax:1,zoomMin:1,zoomStep:1.6,regionsSelectable:false,markersSelectable:false,bindTouchEvents:true,regionStyle:{initial:{fill:"#1fafff","fill-opacity":1,stroke:"#ffffff","stroke-width":1.5,"stroke-opacity":1},hover:{fill:"#ffbc00"},selected:{fill:"#819CC2"},selectedHover:{}},markerStyle:{initial:{fill:"#819CC2",stroke:"#819CC2","fill-opacity":1,"stroke-width":1,"stroke-opacity":1,r:5},hover:{stroke:"#7A93D6","stroke-width":2},selected:{fill:"#819CC2"},selectedHover:{}}};jvm.WorldMap.apiEvents={onRegionLabelShow:"regionLabelShow",onRegionOver:"regionOver",onRegionOut:"regionOut",onRegionClick:"regionClick",onRegionSelected:"regionSelected",onMarkerLabelShow:"markerLabelShow",onMarkerOver:"markerOver",onMarkerOut:"markerOut",onMarkerClick:"markerClick",onMarkerSelected:"markerSelected",onViewportChange:"viewportChange"};